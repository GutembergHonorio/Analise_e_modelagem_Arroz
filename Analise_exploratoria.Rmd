---
title: "Analise exploratória"
author: "Gutemberg Resende Honorio Filho"
date: "23/02/2021"
output: html_document
---
# Pacotes

```{r}

if(!require(tidyverse)) install.packages("tidyverse")
if(!require(patchwork)) install.packages("patchwork")

# para o mapa
if(!require(geobr)) install.packages("geobr")
if(!require(ggspatial)) install.packages("ggspatial")
if(!require(spatstat))  install.packages("spatstat")

# para matrix de correlação
if(!require(PerformanceAnalytics)) install.packages("PerformanceAnalytics")
if(!require(corrplot)) install.packages("corrplot")
if(!require(Hmisc)) install.packages("Hmisc")


# tunel de correlação
if(!require(correlationfunnel)) install.packages("correlationfunnel")

# para  Predictive Power Score (PPS)

 #install.packages('devtools')
#devtools :: install_github ('https://github.com/paulvanderlaken/ppsr.git')
library(ppsr)

# PCA

if(!require(FactoMineR)) install.packages("FactoMineR")
if(!require(factoextra)) install.packages("factoextra")

```

# DADOS


```{r Diretório} 


# DIRETÓRIO DOS DADOS 

Tabelabruta<- read.csv("d:/Users/Cristiane Resende/Desktop/Gutemberg Honorio/Mestrado/Repositorio_4/Analise_e_modelagem_Arroz/Merge_1980_2018.csv", header = TRUE, sep = ",", stringsAsFactors = FALSE) # tabela com os dados originais

# criando coluna com macrorregiões

Tabelabruta<- mutate(Tabelabruta,REGIAO = case_when(UF == 'GO'| UF == 'DF' |UF == 'MS' | UF == 'MT' ~ 'Centro-Oeste',
                              UF == 'AL'| UF == 'BA' |UF == 'CE' | UF == 'MA' | UF == 'PB' | UF == 'PE' | UF == 'PI' | UF == 'RN' | UF == 'SE' ~ 'Nordeste',
                              UF == 'AC' | UF == 'AM' | UF == 'AP' | UF == 'PA' | UF == 'RO' | UF == 'RR' | UF == 'TO' ~ 'Norte',
                              UF == 'ES' | UF == 'MG' | UF == 'SP' | UF == 'RJ' ~ 'Sudeste',
                              UF == 'RS' | UF == 'SC' | UF == 'PR' ~ 'Sul'))

# Tabelas acessório

TabelabrutaIRR = subset(Tabelabruta, SIST_CULT == "IRRIGATED") # Somente Irrigado
TabelabrutaTA = subset(Tabelabruta, SIST_CULT == "UPLAND") # Somente Terras altas

# Filtrando os dados


IRR<-TabelabrutaIRR %>% mutate(UR_Media=(umidade_Media),UR_V=	(umidade_V), UR_fld_m=	(umidade_fld_m),	UR_R=	(umidade_R), Graus_dia_ciclo=(graus_dia_ciclo), Graus_dia_FLO=(graus_dia_FLO+graus_dia_IP))

IRR <- select(IRR,latitude, longitude, GENOTIPO, ID_ENSAIO,ano, Altitude, REGIAO, UF, FLO_E, Tmax_Maxima ,Tmax_fld_m ,	Tmax_R,	Tmax_ACC_R, Tmax_Minima,	Tmax_Media,Tmax_V ,Tmax_ACC_V,	Tmin_Maxima,Tmin_Minima ,	Tmin_Media ,	Tmin_V ,	Tmin_ACC_V , Tmin_fld_m ,	Tmin_R,	Tmin_ACC_R , Chuva_ACC ,	Chuva_ACC_V, Chuva_ACC_R, Rad_ACC_R ,	Rad_ACC ,	Rad_ACC_V, UR_Media, UR_V, UR_fld_m,	UR_R, Graus_dia_ciclo, Graus_dia_FLO, ano)


#rm(TabelabrutaIRR,TabelabrutaTA,Tabelabruta)

# Removendo os genótipos que não serão estudados

IRR = IRR[IRR$GENOTIPO %in% c("ALIANCA",	"AVAXI CL",	"BR IRGA 409",	"BR IRGA 410",	"BR IRGA 412",	"BR IRGA 414",	"BRS 7 TAIM",	"BRS A701 CL",	"BRS A702 CL",	"BRS A704",	"BRS ALVORADA",	"BRS BIGUA",	"BRS CATIANA",	"BRS CIRAD 302",	"BRS FORMOSO",	"BRS FRONTEIRA",	"BRS GUARA",	"BRS JABURU",	"BRS JACANA",	"BRS PAMPA",	"BRS PAMPEIRA",	"BRS PELOTA",	"BRS QUERENCIA",	"BRS SINUELO CL",	"BRS TROPICAL",	"BRSMG RUBELITA",	"CICA 8",	"CT8452",	"DIAMANTE",	"EEA34",	"EMPASC 101",	"EMPASC 102",	"EPAGRI 108",	"EPAGRI 109",	"EPAGRI97-01",	"EPAGRI97-05",	"EPAGRI97-06",	"H6",	"H7 CL",	"IAC1289",	"IAC1298",	"IAC1299",	"IAC1307",	"IAC1311",	"IAPAR 58",	"IRGA 417",	"IRGA 422 CL",	"IRGA 424",	"IRGA 424 RI",	"IRGA 425",	"IRGA 426",	"IRGA 427",	"IRGA 428",	"IRGA 429",	"IRGA 430",	"IRGA97-05",	"IRGA97-10",	"IRGA97-11",	"IRGA97-28",	"JAVAE",	"JEQUITIBA",	"MARAJO",	"METICA 1",	"MOXOTO",	"OUROMINAS",	"PR267",	"PR268",	"PR306",	"PR331",	"PR349",	"PR380",	"PR498",	"PR631",	"PR67",	"PUITA INTA CL",	"RORAIMA",	"SAO FRANCISCO",	"SC138",	"SC173",	"SC237",	"SC240",	"SC250",	"SCS 112",	"SCS 114 ANDOSAN",	"SCS 116 SATORU",	"SCS 121 CL",	"SCSBRS 111",	"SCSBRS 113 TIO TAKA",	"SCSBRS PIRACEMA",	"SG11551",	"URUCUI"),]
IRR = IRR[IRR$UF!="MT",]

# Filtrando e gerando médias

IRR_Medio<- IRR %>% group_by(ID_ENSAIO, GENOTIPO, REGIAO) %>% summarise(  FLO_M= mean(FLO_E),  latitude= mean(latitude), longitude = mean(longitude), Altitude = mean(Altitude), Tmax_Maxima = mean(Tmax_Maxima) ,Tmax_fld_m = mean(Tmax_fld_m ),	Tmax_R= mean( Tmax_R),	Tmax_ACC_R= mean(Tmax_ACC_R ), Tmax_Minima= mean(Tmax_Minima ),	Tmax_Media= mean( Tmax_Media),Tmax_V = mean(Tmax_V ),Tmax_ACC_V= mean(Tmax_ACC_V ),	Tmin_Maxima= mean(Tmin_Maxima ),Tmin_Minima = mean(Tmin_Minima ),	Tmin_Media = mean(Tmin_Media ),	Tmin_V = mean(Tmin_V ),	Tmin_ACC_V = mean(Tmin_ACC_V ), Tmin_fld_m = mean( Tmin_fld_m),	Tmin_R= mean(Tmin_R ),	Tmin_ACC_R = mean(Tmin_ACC_R ), Chuva_ACC = mean(Chuva_ACC ),	Chuva_ACC_V= mean(Chuva_ACC_V ), Chuva_ACC_R= mean(Chuva_ACC_R ), Rad_ACC_R = mean(Rad_ACC_R ),	Rad_ACC = mean(Rad_ACC ),	Rad_ACC_V= mean(Rad_ACC_V ), UR_Media= mean( UR_Media), UR_V= mean( UR_V), UR_fld_m= mean(UR_fld_m ),	UR_R= mean(UR_R ), Graus_dia_ciclo= mean(Graus_dia_ciclo ), Graus_dia_FLO= mean(Graus_dia_FLO ))



# separando por macrorregião

Centro_oeste<- subset(IRR_Medio, (REGIAO == "Centro-Oeste")) # filtrando por região
Norte<- subset(IRR_Medio, (REGIAO == "Norte")) # filtrando por região
Nordeste<- subset(IRR_Medio, (REGIAO == "Nordeste")) # filtrando por região
Sul<- subset(IRR_Medio, (REGIAO == "Sul")) # filtrando por região
Sudeste<- subset(IRR_Medio, (REGIAO == "Sudeste")) # filtrando por região

```

# Visão geral
## Mapa

```{r , include=F}
Brasil<- read_state(code_state="all",year=2010)

latIRR<- IRR %>%
  group_by(ID_ENSAIO) %>% summarise(latitude = unique(latitude) , longitude= unique(longitude)) 
latIRR$geo = c(paste(latIRR$latitude, latIRR$longitude, sep="_"))

a<- latIRR %>%
  group_by(geo) %>% count()

latIRR<- separate(a, col=geo, into=c('latitude', 'longitude'), sep='_')
latIRR$latitude<- as.numeric(latIRR$latitude)
latIRR$longitude<- as.numeric(latIRR$longitude)


names(latIRR) <- c("latitude", "longitude", "Nº_de_ensaios")
  
Mapa<-ggplot() +
  geom_sf(aes(group = code_state), data = Brasil, size = 0.1 , fill = "#FFF7C2") +
  geom_point(aes(x = longitude, y = latitude, size = Nº_de_ensaios), colour = "blue", data = latIRR)+
  labs(x = "Longitude", y = "Latitude", title = "   Distribuição geográfica dos ensaios", size = "Test numbers") +
  annotation_north_arrow(style=north_arrow_fancy_orienteering)+
  annotation_scale(location="br", height = unit(0.15,"cm"))+
  theme_minimal()+
  theme(plot.title = element_text(hjust = 0.5))
rm(Brasil, latTA,latIRR)
```
```{r , echo=FALSE, fig.align='center', out.width='100%', fig.asp=0.6, fig.width=9}
Mapa
```

##Ensaios

### Número de ensáios realizados por macrorregião.
```{r}

macrorregiao_Ensaios<-apply(with(IRR,table(REGIAO,ID_ENSAIO))>0,1:1,sum)
macrorregiao_Ensaios
```

TOTAL de 238 ensaios realizados


Número de ensáios realizados por estado.
```{r}

Estados_Ensaios<-apply(with(IRR,table(UF,ID_ENSAIO))>0,1:1,sum)
Estados_Ensaios
```
```{r}
barplot(macrorregiao_Ensaios, cex.names =  0.8, main = "Ensaios realizados por macrorregião",cex.axis = 0.8, las=2 )
barplot(Estados_Ensaios, cex.names =  0.8, main = "Ensaios realizados por estado" , cex.axis = 0.8)
```
### Núm ensaio  Ano 
```{r}

Ano_ensaio<-apply(with(TabelabrutaIRR,table(ano,ID_ENSAIO))>0,1:1,sum)
Ano_ensaio
```

```{r}

barplot(Ano_ensaio, cex.names =  0.8, main = "Número de ensaios por ano", cex.axis = 0.8, las=2)


```

```{r}
teste<- IRR %>% group_by(ano) %>% summarise(FLO_E = FLO_E)
teste<- teste[teste$ano >= 1995,]

graf_ano_flo = ggplot(teste)+
  geom_smooth(aes(y=FLO_E , x = ano), se = FALSE,method = 'loess', span = 0.9)+
    labs(x = "Year", y = "Flowering (DAE)")+
  scale_x_continuous(breaks=c(seq(1995,2018,5)))+
  scale_y_continuous(breaks=c(seq(80,95,2)))+
  theme_classic()

  
```

## Genótipos

### tendenc. flore. ano de lans. genotipos 
```{r}
# filtrando por região
Ano_GENOTIPO <- IRR 

# filtrando por ano e genótipo
Ano_GENOTIPO<- Ano_GENOTIPO %>% group_by(ano,GENOTIPO) %>% summarise(FLO_M = mean(FLO_E))

# filtrando o primeiro ano de cada genótipo
Ano_lan<- Ano_GENOTIPO %>%group_by(GENOTIPO) %>% filter(ano==min(ano))

Ano_GENOTIPO<- Ano_lan %>% group_by(ano) %>% summarise(FLO_M = FLO_M)
Ano_GENOTIPO<- Ano_GENOTIPO[Ano_GENOTIPO$ano >= 1995,]

graf_ano_genotipo = ggplot(Ano_GENOTIPO)+
  geom_smooth(aes(y=FLO_M , x = ano), se = FALSE, span = 0.99)+
    labs(x = "Year", y = "Flowering (DAE)")+
  scale_x_continuous(breaks=c(seq(1995,2018,5)))+
  scale_y_continuous(breaks=c(seq(80,95,2)))+
  theme_classic()
```

### N. genot. lan. ano

```{r}
Ano_GENOTIPO<-apply(with(Ano_lan,table(ano,GENOTIPO))>0,1:1,sum)
Ano_GENOTIPO
```


```{r}

barplot(Ano_gen, cex.names =  0.8, main = "Número de genotipos lançados por ano ", cex.axis = 0.8, las=2)

```


### Número de genótipos testados por macrorregião.
```{r}

macrorregiao_Genotipo<-apply(with(IRR,table(REGIAO,GENOTIPO))>0,1:1,sum)
macrorregiao_Genotipo
```

TOTAL de 91 genótipos testados

```{r}

d<- data.frame("Regioes" = names(macrorregiao_Ensaios),"quant" = macrorregiao_Ensaios, "Legenda" = "Tests performed")
e<- data.frame("Regioes" = names(macrorregiao_Genotipo),"quant" = macrorregiao_Genotipo, "Legenda" = "Tested genotypes")
aa<- bind_rows(d,e)

graf_ens_reg<-
  ggplot()+
  geom_col(data= aa, aes(y=Regioes , x = quant, fill = Legenda ) ,position = "dodge")+
    theme_classic()+
  labs(y = "Region", x= "", fill = NULL, title = "")+
  scale_fill_viridis_d()+
   theme(legend.position='none')
graf_ens_reg
```

### Número de genótipos testados por estado.
```{r}

Estados_Genotipo<-apply(with(IRR,table(UF,GENOTIPO))>0,1:1,sum)
Estados_Genotipo
```
```{r}
ggplot(IRR)+
  geom_point(aes(x = GENOTIPO, y= UF))
barplot(Estados_Genotipo, cex.names =  0.8, main = "Número de genótipos testados por estado", cex.axis = 0.8, las=2)

```
```{r}

d<- data.frame("Estados" = names(Estados_Ensaios),"quant" = Estados_Ensaios, "Legenda" = "Tests performed")
e<- data.frame("Estados" = names(Estados_Genotipo),"quant" = Estados_Genotipo, "Legenda" = "Tested genotypes")
aa<- bind_rows(d,e)

graf_ens_est<-
  ggplot()+
  geom_col(data= aa, aes(y=Estados , x = quant, fill = Legenda ) ,position = "dodge")+
    theme_classic()+
  labs(y = "States", x= "", fill = NULL, title = "")+
  scale_fill_viridis_d(guide = "none")
graf_ens_est
```

```{r}
((graf_ens_reg | graf_ens_est)+ plot_layout(guides = 'collect') & theme(legend.position='bottom')) + plot_annotation(tag_levels = 'A', tag_prefix = '(', tag_suffix = ')')
```

```{r}
unique(Sudeste$GENOTIPO) %in% unique(Centro_oeste$GENOTIPO) & unique(Sudeste$GENOTIPO) %in% unique(Norte$GENOTIPO) & unique(Sudeste$GENOTIPO) %in% unique(Nordeste$GENOTIPO)& unique(Sudeste$GENOTIPO) %in% unique(Sul$GENOTIPO)

a<- c(unique(Sudeste$GENOTIPO))
a[c(1,3,6,7, 22, 23, 25, 28, 35, 36,39,40,41, 47, 48, 51 )]

```
```{r}
unique(IRR$ID_ENSAIO)

n_ens<-data.frame(table(IRR$ID_ENSAIO))

sort(n_ens$Freq)
summary(n_ens$Freq)
```


```{r}
getmode <- function(v) {
   uniqv <- unique(v)
   uniqv[which.max(tabulate(match(v, uniqv)))]
}

getmode(n_ens$Freq)
boxplot(n_ens$Freq)
ncol(TabelabrutaIRR)
```

### Núm gen. Ano 
```{r}

Ano_GEN<-apply(with(IRR,table(ano,GENOTIPO))>0,1:1,sum)
Ano_GEN
```
```{r}
GEN_Ano<- data.frame(with(IRR,table(GENOTIPO,ano)),  stringsAsFactors = F)
GEN_Ano = GEN_Ano[GEN_Ano$Freq!=0,]
GEN_Ano<- GEN_Ano %>% select(GENOTIPO) %>% mutate(ano = as.Date(GEN_Ano$ano,format = "%Y"))
GEN_Ano$ano<- format(GEN_Ano$ano, format = "%Y")

GEN_Ano<- GEN_Ano %>% group_by(GENOTIPO) %>% summarise(ano = min(ano))
GEN_Ano<- GEN_Ano %>% group_by(GENOTIPO) %>% summarise(ano = min(ano))
```

```{r}
GEN_Ano<- GEN_Ano %>% select(GENOTIPO) %>% mutate(FLO = mean())  
```

```{r}
install.packages("xlsx")
library(xlsx)
write.xlsx(GEN_Ano,file="GEN_Ano.xlsx")

```

```{r}

barplot(Ano_GEN, cex.names =  0.8, main = "Número de genótipos testados por ano", cex.axis = 0.8, las=2)

```

```{r}
unique(IRR$GENOTIPO) %in% unique(IRR$ano)
```
```{r}

aa <- data.frame("Ano" = names(Ano_ensaio), "Nº" = Ano_ensaio, "Legenda" = "Tests in the year")

bb <- data.frame("Ano" = names(Ano_GEN), "Nº" = Ano_GEN, "Legenda" = "Genotypes tested in the year")

cc <- data.frame("Ano" = names(Ano_GENOTIPO), "Nº" = Ano_GENOTIPO, "Legenda" = "Genotypes released in the year")

a<- bind_rows(aa,bb,cc)

a<- a[a$Ano >= 1995,]

ano_geno<-ggplot()+
  geom_col(data= a, aes(x=Ano, y = Nº, fill= Legenda),position = "dodge")+
    theme_classic()+
  labs(y = "", x="Year", fill = NULL)+
  scale_fill_viridis_d()+
  coord_flip()+
  theme(legend.position='bottom')
  


```

```{r}
(ano_geno|(graf_ano_flo / graf_ano_genotipo) )+plot_annotation(tag_levels = 'A', tag_prefix = '(', tag_suffix = ')')

```

## Florescimento

```{r}
ggplot(IRR)+
  geom_boxplot(aes(y=FLO_E , x = REGIAO), fill="grey")+
    labs(x = "Macrorregião", y = "Florescimento (DAE)", title = "Data de florescimento por região")+
  theme_test( base_size= 17)
boxplot(IRR$FLO_E)

par(mfrow=c(3,3))

hist(IRR_Medio$FLO_M, main="Não regionalizado" , xlab= "Data de florescimento")
hist(Centro_oeste$FLO_M, main= "Centro-oeste", xlab= "Data de florescimento")
hist(Norte$FLO_M, main= "Norte", xlab= "Data de florescimento")
hist(Nordeste$FLO_M, main= "Nordeste", xlab= "Data de florescimento")
hist(Sul$FLO_M, main= "Sul", xlab= "Data de florescimento")
hist(Sudeste$FLO_M, main= "Sudeste", xlab= "Data de florescimento")



```
```{r}
summary(IRR$FLO_E)
```
```{r}
summary(Sudeste$FLO_M)
sd(Sudeste$FLO_M)
```
```{r}
summary(Norte$FLO_M)
sd(Norte$FLO_M)
```
```{r}
sd(IRR$FLO_E)
```
```{r}
getmode(IRR$FLO_E)
```


```{r}
cv<-function(x){coef<-sd(x)/mean(x)*100 
return(coef)}

CV<- IRR %>% group_by(GENOTIPO) %>% summarise(FLO_M = mean(FLO_E), Coef_var = cv(FLO_E))

boxplot(CV$Coef_var, main = "Coeficiente de variação para data de florescimento por genótipo")
```


```{r, message=F}
cv<-function(x){coef<-sd(x)/mean(x)*100 
return(coef)}



CV1<- IRR %>% group_by(GENOTIPO,REGIAO) %>% summarise(FLO_M = mean(FLO_E), Coef_var = cv(FLO_E))
ggplot(CV1)+
  geom_boxplot(aes(y=Coef_var , x = REGIAO),fill="grey")+
    labs(x = "Macrorregião", y = "CV (%)", title = "Coeficiente de variação para data de florescimento por genótipo")+
  theme_test( base_size= 17)

CV<- IRR %>% group_by(ID_ENSAIO,REGIAO) %>% summarise(FLO_M = mean(FLO_E), Coef_var = cv(FLO_E))
ggplot(CV)+
  geom_boxplot(aes(y=Coef_var , x = REGIAO))+
    labs(x = "Macrorregião", y = "CV", title = "Coeficiente de variação para data de florescimento por ensaio")
CV<- IRR %>% group_by(GENOTIPO,ID_ENSAIO,REGIAO) %>% summarise(FLO_M = mean(FLO_E), Coef_var = cv(FLO_E))
ggplot(CV)+
  geom_boxplot(aes(y=Coef_var , x = REGIAO))+
    labs(x = "Macrorregião", y = "CV", title = "Coeficiente de variação para data de florescimento por genótipo dentro do ensaio")
```
```{r, message=F}
CV<- IRR %>% group_by(GENOTIPO,ID_ENSAIO,REGIAO) %>% summarise(FLO_M = mean(FLO_E), Coef_var = cv(FLO_E))
View(CV)
```

## anova FLO 

```{r}
modelo <- aov(FLO_E ~ GENOTIPO*latitude , IRR)
summary(modelo)
```


```{r}
modelo <- aov(FLO_E ~ GENOTIPO*longitude , IRR)
summary(modelo)
```


```{r}
modelo <- aov(FLO_E ~ GENOTIPO*Altitude , IRR)
summary(modelo)

```
```{r}
modelo <- aov(log(FLO_E) ~ GENOTIPO*ano , IRR)
summary(modelo)
```

```{r}


Teste<- IRR[IRR$GENOTIPO %in% c("BRS CATIANA", "BRS PAMPEIRA", "EPAGRI 109", "OUROMINAS", "BRS PAMPA", "BR IRGA 409", "IRGA 417", "METICA 1", "BRS FORMOSO", "CICA 8", "JEQUITIBA", "PR306", "PR349", "JAVAE", "SCSBRS 111","BRS JABURU"),]
modelo <- aov(FLO_E ~ GENOTIPO*REGIAO , Teste)
summary(modelo)

```


## Variáveis 
```{r}
ad_variaveis<- IRR %>% group_by(Genotype,REGIAO) %>% summarise(T_Media = (Tmin_Media+Tmax_Media)/2 ,Tmin_Media, Tmax_Media, Tmax_Maxima, Tmin_Minima, UR_Media, Chuva_ACC, Rad_ACC, Graus_dia_FLO,Graus_dia_ciclo)
```

```{r}
a<-ggplot(IRR, aes(x = REGIAO, y = FLO_E, color = REGIAO, fill = REGIAO)) +
    scale_y_continuous() +
  scale_color_viridis_d( guide = "none") +
  scale_fill_viridis_d( guide = "none")+
 geom_violin(
    aes(fill = REGIAO, fill = after_scale(colorspace::lighten(fill, .5))),
    size = 1.2, color = NA
  ) +
  geom_boxplot(
    width = .1, size = 1.2
  ) +
  stat_summary(
    geom = "point",
    fun = median,
    color = "white",
    size = 5
  )+
  theme_classic()+
  labs(x="", y="Flowering (DAE)")

```
```{r}
CV1<- IRR %>% group_by(Genotype,REGIAO) %>% summarise(FLO_M = mean(FLO_E), Coef_var = cv(FLO_E))

b<-ggplot(CV1, aes(x = REGIAO, y = Coef_var, color = REGIAO, fill = REGIAO)) +
  scale_color_viridis_d( guide = "none") +
  scale_fill_viridis_d( guide = "none")+ 
      labs( y = "CV(%)")+
    geom_boxplot(
    aes(fill = REGIAO, fill = after_scale(colorspace::lighten(fill, .5))),
    size = 1.5, outlier.size = 2
  )+
  theme_classic()
```
```{r}
(a|b)+plot_annotation(tag_levels = 'A', tag_prefix = '(', tag_suffix = ')') 

```

```{r}
sd(Centro_oeste$Degree_days_FLO)
```



```{r}
a2<- data.frame("Temperatura" = ad_variaveis$Tmax_Maxima, "REGIAO" = ad_variaveis$REGIAO, "Tipo" = "Tmax_Max")
b2<- data.frame("Temperatura" = ad_variaveis$T_Media, "REGIAO" = ad_variaveis$REGIAO, "Tipo" = "Average temperature")
c2<- data.frame("Temperatura" = ad_variaveis$Tmin_Minima, "REGIAO" = ad_variaveis$REGIAO, "Tipo" = "Tmin_Min")




a2<- ggplot(a2, aes(y=Temperatura, x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Tmax_Max (ºC)",x= "", )

b2<-ggplot(b2, aes(y=Temperatura, x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Average temperature (ºC)",x= "")


c2<-ggplot(c2, aes(y=Temperatura, x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Tmin_Min (ºC)",x= "")+
    scale_y_continuous(labels= scales::number_format(accuracy = 0.1,
                                 decimal.mark = '.'))

(a2/b2/c2)+plot_annotation(tag_levels = 'A', tag_prefix = '(', tag_suffix = ')')
```


```{r}
d<- ggplot(ad_variaveis, aes(y=UR_Media, x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "HU_M (%)",x= "")
```
```{r}

e<- ggplot(ad_variaveis, aes(y=Chuva_ACC, x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Rainfall_ACC (mm)",x= "")
```
```{r}


f<- ggplot(ad_variaveis, aes(y=Rad_ACC, x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Rad_ACC (MJ/m²)",x= "")

```
```{r}
(d/e/f)+plot_annotation(tag_levels = 'A', tag_prefix = '(', tag_suffix = ')')
```
```{r}
summary(Sul$UR_Media)
```


```{r}
a3<- data.frame("graus" = ad_variaveis$Graus_dia_ciclo, "REGIAO" = ad_variaveis$REGIAO, "Tipo" = "Degree_days_cycle")
b3<- data.frame("graus" = ad_variaveis$Graus_dia_FLO, "REGIAO" = ad_variaveis$REGIAO, "Tipo" = "Degree_days_FLO")
temp<- data.frame()
temp<- bind_rows(a3,b3)

g<-  ggplot(temp)+
  geom_boxplot(aes(y=graus, color = Tipo))+
      labs(y = "Degree days (ºC)", color = NULL)+
scale_color_manual(values = c( "red","blue" 
 )) +
  theme_bw()+
        theme(legend.position="bottom", axis.text.x=element_blank(),strip.background = element_blank(),
  strip.text.x = element_blank())+
 facet_wrap(~ REGIAO, ncol=5)
g
 

ggplot(temp, aes(y=graus, x= REGIAO, color = Tipo, fill = Tipo))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15), alpha = .5
  ) +
  scale_color_viridis_d(labels = c("Degree_days_cycle", "Degree_days_FLO")) +
    scale_fill_viridis_d( guide = "none") +
    theme_classic()+
        theme(legend.position="bottom")+
       labs(y = "Degree days (ºC)",x= "", color = NULL, fill = NULL)



```
```{r}
h<- ggplot(ad_variaveis)+
  geom_boxplot(aes(y=Graus_dia_FLO , color = REGIAO))+
      labs( y = "Graus-dia (ºC)")+
  theme_bw()+
     scale_color_viridis_d()+
   theme(legend.position="none", axis.text.x=element_blank(), strip.background = element_blank(),
  strip.text.x = element_blank())+
 facet_grid(~ REGIAO)
h

```



```{r}
a/b/d/e/f/c/g +plot_annotation(tag_levels = 'A', tag_prefix = '(', tag_suffix = ')') 

```

```{r}
teste<- subset(ad_variaveis, (REGIAO == "Centro_Oeste"))
summary(teste)
```
```{r}
sd(teste$T_Media)
```

```{r}
teste<- subset(ad_variaveis, (REGIAO == "Sul"))
summary(teste)
```
```{r}
sd(teste$T_Media)
```

```{r}
teste<- subset(ad_variaveis, (REGIAO == "Norte"))
summary(teste)
```
```{r}
sd(teste$T_Media)
```
```{r}
teste<- subset(ad_variaveis, (REGIAO == "Nordeste"))
summary(teste)
```
```{r}
sd(teste$T_Media)
```
```{r}
teste<- subset(ad_variaveis, (REGIAO == "Sudeste"))
summary(teste)
```
```{r}
sd(teste$T_Media)
```

## Boxplot



```{r}
# Variáveis com escala menor
Temporario<- IRR[,c(-1,-2,-3,-4,-5,-6,-7,-11,-15,-20,-23,-24,-25,-26,-27,-28,-29,-34,-35)] # retirando as variáveis com escala maior

boxplot(Temporario, horizontal = T, las = 1, cex.axis=0.55, main = "Boxplot com os valores originais")

Temporario<- IRR_Medio[,c(-1,-2,-3,-4,-8,-12,-17,-20,-21,-22,-23,-24,-25,-26,-31,-32)] # retirando as variáveis com escala maior

boxplot(Temporario, horizontal = T, las = 1, cex.axis=0.55, main = "Boxplot com os valores das médias por genótipo/ensaio/região")

# filtrando por região
Temporario<- subset(IRR_Medio, (REGIAO == "Centro_Oeste"))
Temporario<- Temporario[,c(-1,-2,-3,-4,-8,-12,-17,-20,-21,-22,-23,-24,-25,-26,-31,-32)] # retirando as variáveis com escala maior
boxplot(Temporario, horizontal = T, las = 1, cex.axis=0.55, main = "Boxplot com os valores das médias por genótipo/ensaio para Centro-oeste")
Temporario<- subset(IRR_Medio, (REGIAO == "Norte"))
Temporario<- Temporario[,c(-1,-2,-3,-4,-8,-12,-17,-20,-21,-22,-23,-24,-25,-26,-31,-32)] # retirando as variáveis com escala maior
boxplot(Temporario, horizontal = T, las = 1, cex.axis=0.55, main = "Boxplot com os valores das médias por genótipo/ensaio para Norte")
Temporario<- subset(IRR_Medio, (REGIAO == "Nordeste"))
Temporario<- Temporario[,c(-1,-2,-3,-4,-8,-12,-17,-20,-21,-22,-23,-24,-25,-26,-31,-32)] # retirando as variáveis com escala maior
boxplot(Temporario, horizontal = T, las = 1, cex.axis=0.55, main = "Boxplot com os valores das médias por genótipo/ensaio para Nordeste")
Temporario<- subset(IRR_Medio, (REGIAO == "Sul"))
Temporario<- Temporario[,c(-1,-2,-3,-4,-8,-12,-17,-20,-21,-22,-23,-24,-25,-26,-31,-32)] # retirando as variáveis com escala maior
boxplot(Temporario, horizontal = T, las = 1, cex.axis=0.55, main = "Boxplot com os valores das médias por genótipo/ensaio para Sul")
Temporario<- subset(IRR_Medio, (REGIAO == "Sudeste"))
Temporario<- Temporario[,c(-1,-2,-3,-4,-8,-12,-17,-20,-21,-22,-23,-24,-25,-26,-31,-32)] # retirando as variáveis com escala maior
boxplot(Temporario, horizontal = T, las = 1, cex.axis=0.55, main = "Boxplot com os valores das médias por genótipo/ensaio para Sudeste")

```
```{r}
# variáveis com escala maior
Temporario<- IRR[,c(11,15,20,23,24,25,26,27,28,29,34,35)] # retirando as variáveis com escala maior
boxplot(Temporario, horizontal = T, las = 1, cex.axis=0.55, main = "Boxplot com os valores originais")
Temporario<- IRR_Medio[,c(8,12,17,20,21,22,23,24,25,26,31,32)] # retirando as variáveis com escala maior
boxplot(Temporario, horizontal = T, las = 1, cex.axis=0.55, main = "Boxplot com os valores das médias por genótipo/ensaio/região")

# filtrando por região
Temporario<- subset(IRR_Medio, (REGIAO == "Centro_Oeste"))
Temporario<- Temporario[,c(8,12,17,20,21,22,23,24,25,26,31,32)] # retirando as variáveis com escala maior
boxplot(Temporario, horizontal = T, las = 1, cex.axis=0.55, main = "Boxplot com os valores das médias por genótipo/ensaio para Centro-oeste")
Temporario<- subset(IRR_Medio, (REGIAO == "Norte"))
Temporario<- Temporario[,c(8,12,17,20,21,22,23,24,25,26,31,32)] # retirando as variáveis com escala maior
boxplot(Temporario, horizontal = T, las = 1, cex.axis=0.55, main = "Boxplot com os valores das médias por genótipo/ensaio para Norte")
Temporario<- subset(IRR_Medio, (REGIAO == "Nordeste"))
Temporario<- Temporario[,c(8,12,17,20,21,22,23,24,25,26,31,32)] # retirando as variáveis com escala maior
boxplot(Temporario, horizontal = T, las = 1, cex.axis=0.55, main = "Boxplot com os valores das médias por genótipo/ensaio para Nordeste")
Temporario<- subset(IRR_Medio, (REGIAO == "Sul"))
Temporario<- Temporario[,c(8,12,17,20,21,22,23,24,25,26,31,32)] # retirando as variáveis com escala maior
boxplot(Temporario, horizontal = T, las = 1, cex.axis=0.55, main = "Boxplot com os valores das médias por genótipo/ensaio para Sul")
Temporario<- subset(IRR_Medio, (REGIAO == "Sudeste"))
Temporario<- Temporario[,c(8,12,17,20,21,22,23,24,25,26,31,32)] # retirando as variáveis com escala maior
boxplot(Temporario, horizontal = T, las = 1, cex.axis=0.55, main = "Boxplot com os valores das médias por genótipo/ensaio para Sudeste")

```


```{r}
ad_variaveis<- IRR %>% group_by(GENOTIPO,REGIAO) %>% summarise(T_Media = (Tmin_Media+Tmax_Media)/2 ,Tmin_Media, Tmax_Media, Tmax_Maxima, Tmin_Minima, UR_Media, Chuva_ACC, Rad_ACC, Graus_dia_ciclo,Graus_dia_FLO)
ggplot(ad_variaveis)+
  geom_boxplot(aes(y=Tmin_Media , x = REGIAO),fill="grey")+
    labs(x = "Macrorregião", y = "Temperatura (Cº)", title = "Tmin_Media")+
  theme_test( base_size= 17)
ggplot(ad_variaveis)+
  geom_boxplot(aes(y=Tmax_Media , x = REGIAO),fill="grey")+
    labs(x = "Macrorregião", y = "Temperatura (Cº)", title = "Tmax_Media")+
  theme_test( base_size= 17)

ggplot(ad_variaveis)+
  geom_boxplot(aes(y=Tmin_Minima , x = REGIAO),fill="grey")+
    labs(x = "Macrorregião", y = "Temperatura (Cº)", title = "Tmin_Minima")+
  theme_test( base_size= 17)


ggplot(ad_variaveis)+
  geom_boxplot(aes(y=Tmax_Maxima , x = REGIAO),fill="grey")+
    labs(x = "Macrorregião", y = "Temperatura (Cº)", title = "Tmax_Maxima")+
  theme_test( base_size= 17)

ggplot(ad_variaveis)+
  geom_boxplot(aes(y=T_Media , x = REGIAO),fill="grey")+
    labs(x = "Macrorregião", y = "Temperatura média (Cº)", title = "Temperatura média")+
  theme_test( base_size= 17)

ggplot(ad_variaveis)+
  geom_boxplot(aes(y=UR_Media , x = REGIAO),fill="grey")+
    labs(x = "Macrorregião", y = "Umidade relativa (%)", title = "Umidade relativa")+
  theme_test( base_size= 17)

ggplot(ad_variaveis)+
  geom_boxplot(aes(y=Chuva_ACC , x = REGIAO),fill="grey")+
    labs(x = "Macrorregião", y = "Milimetros (mm)", title = "chuva")+
  theme_test( base_size= 17)

ggplot(ad_variaveis)+
  geom_boxplot(aes(y=Rad_ACC , x = REGIAO),fill="grey")+
    labs(x = "Macrorregião", y = "Radiação solar global (W/m²)", title = "Rad_ACC")+
  theme_test( base_size= 17)

ggplot(ad_variaveis)+
  geom_boxplot(aes(y=Graus_dia_ciclo , x = REGIAO),fill="grey")+
    labs(x = "Macrorregião", y = "Graus-dia (Cº)", title = "Graus_dia_ciclo")+
  theme_test( base_size= 17)

ggplot(ad_variaveis)+
  geom_boxplot(aes(y=Graus_dia_FLO , x = REGIAO),fill="grey")+
    labs(x = "Macrorregião", y = "Graus-dia (Cº)", title = "Graus_dia_FLO")+
  theme_test( base_size= 17)
```




## Matrix de correlação

```{r}
Temporario<-IRR_Medio[,c(-1,-2,-3)]
chart.Correlation(Temporario, histogram = T)
title("Matrix de correlação", line = 1)

Temporario<- subset(IRR_Medio, (REGIAO == "Centro-oeste"))
Temporario<- Temporario[,c(-1,-2,-3)]
chart.Correlation(Temporario, histogram = T)
title("Matrix de correlação Centro-oeste", line = 1)

Temporario<- subset(IRR_Medio, (REGIAO == "Norte"))
Temporario<- Temporario[,c(-1,-2,-3)]
chart.Correlation(Temporario, histogram = T)
title("Matrix de correlação Norte", line = 1)

Temporario<- subset(IRR_Medio, (REGIAO == "Nordeste"))
Temporario<- Temporario[,c(-1,-2,-3)]
chart.Correlation(Temporario, histogram = T)
title("Matrix de correlação Nordeste", line = 1)

Temporario<- subset(IRR_Medio, (REGIAO == "Sul"))
Temporario<- Temporario[,c(-1,-2,-3)]
chart.Correlation(Temporario, histogram = T)
title("Matrix de correlação Sul", line = 1)

Temporario<- subset(IRR_Medio, (REGIAO == "Sudeste"))
Temporario<- Temporario[,c(-1,-2,-3)]
chart.Correlation(Temporario, histogram = T)
title("Matrix de correlação Sudeste", line = 1)
```


##  Predictive Power Score (PPS)

```{r}

Temporario<-IRR_Medio[,c(-1,-2,-3)]
pps1<- ppsr :: visualize_pps ( df = Temporario, y  = "FLO_M" ) + 
ggplot2 :: labs ( title  =  'Brazil',y = "" )+
  theme(legend.position = "none")


Temporario<- subset(IRR_Medio, (REGIAO == "Centro-Oeste"))
Temporario<- Temporario[,c(-1,-2,-3)]
pps2<-ppsr :: visualize_pps ( df = Temporario, y  = "FLO_M" ) + 
 ggplot2 :: labs ( title  =  'Midwest',y = ""  )+
  theme(legend.position = "none")

Temporario<- subset(IRR_Medio, (REGIAO == "Norte"))
Temporario<- Temporario[,c(-1,-2,-3)]
pps3<-ppsr :: visualize_pps ( df = Temporario, y  = "FLO_M"  ) + 
 ggplot2 :: labs ( title  =  'North',y = ""  )+
  theme(legend.position = "none")

Temporario<- subset(IRR_Medio, (REGIAO == "Nordeste"))
Temporario<- Temporario[,c(-1,-2,-3)]
pps4<-ppsr :: visualize_pps ( df = Temporario, y  = "FLO_M" ) + 
 ggplot2 :: labs ( title  =  'Northeast',y = ""  )+
  theme(legend.position = "none")

Temporario<- subset(IRR_Medio, (REGIAO == "Sul"))
Temporario<- Temporario[,c(-1,-2,-3)]
pps5<-ppsr :: visualize_pps ( df = Temporario, y  = "FLO_M" ) + 
 ggplot2 :: labs ( title  =  'South' ,y = "" )+
  theme(legend.position = "none")

Temporario<- subset(IRR_Medio, (REGIAO == "Sudeste"))
Temporario<- Temporario[,c(-1,-2,-3)]
pps6<-ppsr :: visualize_pps ( df = Temporario, y  = "FLO_M") + 
 ggplot2 :: labs ( title  =  'Southeast',y = ""  )+
  theme(legend.position = "none")

(pps1+pps2+pps3)/(pps5+pps4+pps6)+plot_annotation(tag_levels = 'A', tag_prefix = '(', tag_suffix = ')')

```

```{r}


Temporario<-IRR_Medio[,c(-1,-2,-3)]
pps7<-ppsr :: visualize_pps ( df = Temporario) + 
 ggplot2 :: labs ( title  =  'PPS com dados não regionalizados' )

Temporario<- subset(IRR_Medio, (REGIAO == "Centro_Oeste"))
Temporario<- Temporario[,c(-1,-2,-3)]
pps8<-ppsr :: visualize_pps ( df = Temporario ) + 
 ggplot2 :: labs ( title  =  'PPS Centro-Oeste' )

Temporario<- subset(IRR_Medio, (REGIAO == "Norte"))
Temporario<- Temporario[,c(-1,-2,-3)]
pps9<-ppsr :: visualize_pps ( df = Temporario ) + 
 ggplot2 :: labs ( title  =  'PPS Norte' )

Temporario<- subset(IRR_Medio, (REGIAO == "Nordeste"))
Temporario<- Temporario[,c(-1,-2,-3)]
pps10<-ppsr :: visualize_pps ( df = Temporario ) + 
 ggplot2 :: labs ( title  =  'PPS Nordeste' )

Temporario<- subset(IRR_Medio, (REGIAO == "Sul"))
Temporario<- Temporario[,c(-1,-2,-3)]
pps11<-ppsr :: visualize_pps ( df = Temporario ) + 
 ggplot2 :: labs ( title  =  'PPS Sul' )

Temporario<- subset(IRR_Medio, (REGIAO == "Sudeste"))
Temporario<- Temporario[,c(-1,-2,-3)]
pps12<-ppsr :: visualize_pps ( df = Temporario ) + 
 ggplot2 :: labs ( title  =  'PPS Sudeste' )

pps11 

```

## Analise de componentes principais (PCA)

```{r}
Temporario<-IRR_Medio[,c(-1,-2,-3)]
res_pca<- PCA(Temporario, graph = F)
pca1<- fviz_eig(res_pca,addlabels = T)+
  theme_bw()+
  labs(title = "PCA com os dados não regionálizados")
pca1_2<-fviz_pca_biplot(res_pca,geom.ind = "point") +
  theme_bw()+
  labs(title = "PCA com os dados não regionálizados")

Temporario<-Centro_oeste[,c(-1,-2,-3)]
res_pca<- PCA(Temporario, graph = F)
pca2<-fviz_eig(res_pca,addlabels = T)+
  theme_bw()+
  labs(title = "PCA  Centro-oeste")
pca2_2<-fviz_pca_biplot(res_pca,geom.ind = "point") +
  theme_bw()+
  labs(title = "PCA  Centro-oeste")

Temporario<-Norte[,c(-1,-2,-3)]
res_pca<- PCA(Temporario, graph = F)
pca3<-fviz_eig(res_pca,addlabels = T)+
  theme_bw()+
  labs(title = "PCA  Norte")
pca3_3<-fviz_pca_biplot(res_pca,geom.ind = "point") +
  theme_bw()+
  labs(title = "PCA  Norte")

Temporario<-Nordeste[,c(-1,-2,-3)]
res_pca<- PCA(Temporario, graph = F)
pca4<-fviz_eig(res_pca,addlabels = T)+
  theme_bw()+
  labs(title = "PCA  Nordeste")
pca4_4<-fviz_pca_biplot(res_pca,geom.ind = "point") +
  theme_bw()+
  labs(title = "PCA  Nordeste")

Temporario<-Sul[,c(-1,-2,-3)]
res_pca<- PCA(Temporario, graph = F)
pca5<-fviz_eig(res_pca,addlabels = T)+
  theme_bw()+
  labs(title = "PCA  Sul")
pca5_5<-fviz_pca_biplot(res_pca,geom.ind = "point") +
  theme_bw()+
  labs(title = "PCA  Sul")

Temporario<-Sudeste[,c(-1,-2,-3)]
res_pca<- PCA(Temporario, graph = F)
pca6<-fviz_eig(res_pca,addlabels = T)+
  theme_bw()+
  labs(title = "PCA  Sudeste")
pca6_6<-fviz_pca_biplot(res_pca,geom.ind = "point") +
  theme_bw()+
  labs(title = "PCA  Sudeste")


pca5
pca5_5
```


```{r}
summary(Sul$Tmax_V)
boxplot(Sul$)

sd(Sul$Tmax_V)
```
```{r}
a<- ggplot(IRR, aes(x = REGIAO, y = Tmax_V, color = REGIAO, fill = REGIAO)) +
    scale_y_continuous() +
  scale_color_viridis_d( guide = "none") +
  scale_fill_viridis_d( guide = "none")+
 geom_violin(
    aes(fill = REGIAO, fill = after_scale(colorspace::lighten(fill, .5))),
    size = 1.2, color = NA
  ) +
  geom_boxplot(
    width = .1, size = 1.2
  ) +
  stat_summary(
    geom = "point",
    fun = median,
    color = "white",
    size = 5
  )+
  theme_classic()+
  labs(x="", y="Florescimento observado (DAE)")

```

# box2

```{r}
a<- ggplot(IRR, aes(y=Tmax_fld_m, x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Tmax_FLO (ºC)",x= "")

b<- ggplot(IRR, aes(y=UR_V, x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "HU_V (%)",x= "")

c<- ggplot(IRR, aes(y=Tmax_V, x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Tmax_V (ºC)",x= "")

e<- ggplot(IRR, aes(y=Tmin_V, x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Tmin_V (ºC)",x= "")

d<- ggplot(IRR, aes(y=Tmax_V, x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Tmax_V (ºC)",x= "")

f<- ggplot(IRR, aes(y=Tmin_Maxima, x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Tmin_Max (ºC)",x= "")

g<- ggplot(IRR, aes(y=Tmin_ACC_R, x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Tmin_ACC_R (ºC)",x= "")

h<- ggplot(IRR, aes(y=Tmin_ACC_V, x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Tmin_ACC_V (ºC)",x= "")

i<- ggplot(IRR, aes(y=Tmax_V , x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Tmax_V (ºC)",x= "")

i<- ggplot(IRR, aes(y=Tmax_R , x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Tmax_R (ºC)",x= "")

j<- ggplot(IRR, aes(y=Tmax_Minima , x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Tmax_Min (ºC)",x= "")

k<- ggplot(IRR, aes(y=Tmax_ACC_R , x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Tmax_ACC_R (ºC)",x= "")


l<- ggplot(IRR, aes(y=Tmax_ACC_V , x= REGIAO, color = REGIAO, fill = REGIAO))+
geom_boxplot(
    width = .2, fill = "white",
    size = 1
  ) +
  ggdist::stat_halfeye(
    #adjust = .33, ## bandwidth
    width = .67, 
    color = NA, ## remove slab interval
    position = position_nudge(x = .15)
  ) +
  scale_color_viridis_d() +
  scale_fill_viridis_d( guide = "none") +
  theme_classic()+
        theme(legend.position="none")+
       labs(y = "Tmax_ACC_V (ºC)",x= "")



a/c/b/d/e/f/g/h/i/j/k/l

e/d/b
```
```{r}
1335/37
```




