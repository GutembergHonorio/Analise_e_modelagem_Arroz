---
title: "Regressão linear multipla para arroz irrigado"
author: "Gutemberg Resende Honorio Filho"
date: "23/02/2021"
output: html_document
---
# Pacotes

```{r}
if(!require(tidyverse)) install.packages("tidyverse")

```

# DADOS
```{r Diretório} 

# DIRETÓRIO DOS DADOS 

Tabelabruta<- read.csv("d:/Users/Cristiane Resende/Desktop/Gutemberg Honorio/Mestrado/Repositorio_4\Analise_e_modelagem_Arroz/Merge_1980_2018.csv", header = TRUE, sep = ",", stringsAsFactors = FALSE) # tabela com os dados originais

# criando coluna com macrorregiões

Tabelabruta<- mutate(Tabelabruta,REGIAO = case_when(UF == 'GO'| UF == 'DF' |UF == 'MS' | UF == 'MT' ~ 'Centro_Oeste',
                              UF == 'AL'| UF == 'BA' |UF == 'CE' | UF == 'MA' | UF == 'PB' | UF == 'PE' | UF == 'PI' | UF == 'RN' | UF == 'SE' ~ 'Nordeste',
                              UF == 'AC' | UF == 'AM' | UF == 'AP' | UF == 'PA' | UF == 'RO' | UF == 'RR' | UF == 'TO' ~ 'Norte',
                              UF == 'ES' | UF == 'MG' | UF == 'SP' | UF == 'RJ' ~ 'Sudeste',
                              UF == 'RS' | UF == 'SC' | UF == 'PR' ~ 'Sul'))

# Tabelas acessório

TabelabrutaIRR = subset(Tabelabruta, SIST_CULT == "IRRIGATED") # Somente Irrigado
TabelabrutaTA = subset(Tabelabruta, SIST_CULT == "UPLAND") # Somente Terras altas

# Filtrando os dados


IRR<-TabelabrutaIRR %>% mutate(UR_Media=(umidade_Media),UR_V=	(umidade_V), UR_fld_m=	(umidade_fld_m),	UR_R=	(umidade_R), Graus_dia_ciclo=(graus_dia_ciclo), Graus_dia_FLO=(graus_dia_FLO+graus_dia_IP))

IRR <- select(IRR,latitude, longitude, GENOTIPO, ID_ENSAIO, REGIAO, UF, FLO_E, Tmax_Maxima ,Tmax_fld_m ,	Tmax_R,	Tmax_ACC_R, Tmax_Minima,	Tmax_Media,Tmax_V ,Tmax_ACC_V,	Tmin_Maxima,Tmin_Minima ,	Tmin_Media ,	Tmin_V ,	Tmin_ACC_V , Tmin_fld_m ,	Tmin_R,	Tmin_ACC_R , Chuva_ACC ,	Chuva_ACC_V, Chuva_ACC_R, Rad_ACC_R ,	Rad_ACC ,	Rad_ACC_V, UR_Media, UR_V, UR_fld_m,	UR_R, Graus_dia_ciclo, Graus_dia_FLO)

TA<-TabelabrutaTA %>% mutate(UR_Media=(umidade_Media),UR_V=	(umidade_V), UR_fld_m=	(umidade_fld_m),	UR_R=	(umidade_R), Graus_dia_ciclo=(graus_dia_ciclo), Graus_dia_FLO=(graus_dia_FLO+graus_dia_IP))

TA <- select(TA,latitude, longitude, GENOTIPO, ID_ENSAIO, REGIAO, UF, FLO_E, Tmax_Maxima ,Tmax_fld_m ,	Tmax_R,	Tmax_ACC_R, Tmax_Minima,	Tmax_Media,Tmax_V ,Tmax_ACC_V,	Tmin_Maxima,Tmin_Minima ,	Tmin_Media ,	Tmin_V ,	Tmin_ACC_V , Tmin_fld_m ,	Tmin_R,	Tmin_ACC_R , Chuva_ACC ,	Chuva_ACC_V, Chuva_ACC_R, Rad_ACC_R ,	Rad_ACC ,	Rad_ACC_V, UR_Media, UR_V, UR_fld_m,	UR_R, Graus_dia_ciclo, Graus_dia_FLO)

rm(TabelabrutaIRR,TabelabrutaTA,Tabelabruta)

# Removendo os genótipos que não serão estudados

IRR = IRR[IRR$GENOTIPO %in% c("ALIANCA",	"AVAXI CL",	"BR IRGA 409",	"BR IRGA 410",	"BR IRGA 412",	"BR IRGA 414",	"BRS 7 TAIM",	"BRS A701 CL",	"BRS A702 CL",	"BRS A704",	"BRS ALVORADA",	"BRS BIGUA",	"BRS CATIANA",	"BRS CIRAD 302",	"BRS FORMOSO",	"BRS FRONTEIRA",	"BRS GUARA",	"BRS JABURU",	"BRS JACANA",	"BRS PAMPA",	"BRS PAMPEIRA",	"BRS PELOTA",	"BRS QUERENCIA",	"BRS SINUELO CL",	"BRS TROPICAL",	"BRSMG RUBELITA",	"CICA 8",	"CT8452",	"DIAMANTE",	"EEA34",	"EMPASC 101",	"EMPASC 102",	"EPAGRI 108",	"EPAGRI 109",	"EPAGRI97-01",	"EPAGRI97-05",	"EPAGRI97-06",	"H6",	"H7 CL",	"IAC1289",	"IAC1298",	"IAC1299",	"IAC1307",	"IAC1311",	"IAPAR 58",	"IRGA 417",	"IRGA 422 CL",	"IRGA 424",	"IRGA 424 RI",	"IRGA 425",	"IRGA 426",	"IRGA 427",	"IRGA 428",	"IRGA 429",	"IRGA 430",	"IRGA97-05",	"IRGA97-10",	"IRGA97-11",	"IRGA97-28",	"JAVAE",	"JEQUITIBA",	"MARAJO",	"METICA 1",	"MOXOTO",	"OUROMINAS",	"PR267",	"PR268",	"PR306",	"PR331",	"PR349",	"PR380",	"PR498",	"PR631",	"PR67",	"PUITA INTA CL",	"RORAIMA",	"SAO FRANCISCO",	"SC138",	"SC173",	"SC237",	"SC240",	"SC250",	"SCS 112",	"SCS 114 ANDOSAN",	"SCS 116 SATORU",	"SCS 121 CL",	"SCSBRS 111",	"SCSBRS 113 TIO TAKA",	"SCSBRS PIRACEMA",	"SG11551",	"URUCUI"),]
IRR = IRR[IRR$UF!="MT",]

# Filtrando e gerando médias

IRR_Medio<- IRR %>% group_by(ID_ENSAIO, GENOTIPO, REGIAO) %>% summarise(  FLO_M= mean(FLO_E), Tmax_Maxima = mean(Tmax_Maxima) ,Tmax_fld_m = mean(Tmax_fld_m ),	Tmax_R= mean( Tmax_R),	Tmax_ACC_R= mean(Tmax_ACC_R ), Tmax_Minima= mean(Tmax_Minima ),	Tmax_Media= mean( Tmax_Media),Tmax_V = mean(Tmax_V ),Tmax_ACC_V= mean(Tmax_ACC_V ),	Tmin_Maxima= mean(Tmin_Maxima ),Tmin_Minima = mean(Tmin_Minima ),	Tmin_Media = mean(Tmin_Media ),	Tmin_V = mean(Tmin_V ),	Tmin_ACC_V = mean(Tmin_ACC_V ), Tmin_fld_m = mean( Tmin_fld_m),	Tmin_R= mean(Tmin_R ),	Tmin_ACC_R = mean(Tmin_ACC_R ), Chuva_ACC = mean(Chuva_ACC ),	Chuva_ACC_V= mean(Chuva_ACC_V ), Chuva_ACC_R= mean(Chuva_ACC_R ), Rad_ACC_R = mean(Rad_ACC_R ),	Rad_ACC = mean(Rad_ACC ),	Rad_ACC_V= mean(Rad_ACC_V ), UR_Media= mean( UR_Media), UR_V= mean( UR_V), UR_fld_m= mean(UR_fld_m ),	UR_R= mean(UR_R ), Graus_dia_ciclo= mean(Graus_dia_ciclo ), Graus_dia_FLO= mean(Graus_dia_FLO ))

# separando por macrorregião

Centro_oeste<- subset(IRR_Medio, (REGIAO == "Centro_Oeste")) # filtrando por região
Norte<- subset(IRR_Medio, (REGIAO == "Norte")) # filtrando por região
Nordeste<- subset(IRR_Medio, (REGIAO == "Nordeste")) # filtrando por região
Sul<- subset(IRR_Medio, (REGIAO == "Sul")) # filtrando por região
Sudeste<- subset(IRR_Medio, (REGIAO == "Sudeste")) # filtrando por região

```

## CENTRO-OESTE

### Modelo inicial
```{r}

Temporario <- Centro_oeste[,c(-1,-3)] # retirando as vaiáveis REGIAO e ID_ENSAIO

modelo<-lm(log(FLO_M)~., Temporario) # modelo inicial
summary(modelo)
```

### Remoção de não significantes

Ordem da remoção das variáveis numéricas

UR_V (p-valor = 0,928726); Rad_ACC_V (p-valor = 0,922699); Tmin_fld_m	(p-valor = 0,826268); UR_R (p-valor=	0,813551); Rad_ACC_R	(p-valor = 0,736153); UR_Media	(p-valor = 0,748104); Tmax_ACC_V	(p-valor = 0,61396); Tmax_V	(p-valor = 0,873557); Tmin_Media	(p-valor = 0,29712); Tmin_V	(p-valor =	0,356285); Rad_ACC (p-valor = 0.221836); Tmax_Maxima (p-valor = 0.206061); Tmax_Minima (p-valor = 0.170111); UR_fld_m (p-valor = 0.188216)

```{r}
Temporario1<-Temporario %>% select(-UR_V, - Rad_ACC_V,-Tmin_fld_m, -UR_R, -Rad_ACC_R, -UR_Media, -Tmax_ACC_V, -Tmax_V, -Tmin_Media, -Tmin_V, -Rad_ACC, -Tmax_Maxima, -Tmax_Minima, -UR_fld_m)
modelo<-lm(log(FLO_M)~., Temporario1) # modelo inicial
summary(modelo)
```
Substituindo genótipos não significativos e > que 10% por "nao_significante"

O genótipo BR IRGA 409 é o intercepto

```{r}
Genotipos  <- Temporario1$GENOTIPO
SELECAO_GEN <- c("IRGA 425",	"PR498",	"EMPASC 102",	"BR IRGA 410",	"IRGA 426",	"BRS JACANA",	"IRGA97-28",	"IRGA 424 RI",	"SC240",	"BRS A701 CL",	"PR631",	"IRGA 424",	"SC250",	"BRS FRONTEIRA",	"EPAGRI97-06",	"BRS CIRAD 302",	"BRS SINUELO CL",	"JEQUITIBA",	"EPAGRI97-05",	"BRS A702 CL",	"IRGA 427",	"PR306",	"BRS PELOTA",	"PR349",	"EPAGRI97-01",	"IRGA 417",	"BRS PAMPA",	"SC237",	"BRS 7 TAIM")

Temporario1$GENOTIPO <- c(ifelse(Temporario1$GENOTIPO %in% SELECAO_GEN, "Nao_significativo" , Genotipos))
modelo<-lm(log(FLO_M)~., Temporario1) 
summary(modelo)
```

Remoção dos genótipos que não significantes remanecentes.

```{r}
Genotipos  <- Temporario1$GENOTIPO
SELECAO_GEN <- c("SG11551",	"SCSBRS 111",	"JAVAE",	"IRGA 422 CL",	"IRGA97-11","Nao_significativo")

Temporario1$GENOTIPO <- c(ifelse(Temporario1$GENOTIPO %in% SELECAO_GEN, "Nao_significativo" , Genotipos))
modelo<-lm(log(FLO_M)~., Temporario1) 
summary(modelo)
```
Remoção da variável Tmax_ACC_R que perdeu significancia

```{r}
Temporario1<-Temporario1 %>% select(-Tmax_ACC_R)
modelo<-lm(log(FLO_M)~., Temporario1)
summary(modelo)
```
Remoção da variável Tmax_fld_m que perdeu significancia

```{r}
Temporario1<-Temporario1 %>% select(-Tmax_fld_m)
modelo<-lm(log(FLO_M)~., Temporario1)
summary(modelo)
```
Remoção da variável Chuva_ACC_R que perdeu significancia

```{r}
Temporario1<-Temporario1 %>% select(-Chuva_ACC_R)
modelo<-lm(log(FLO_M)~., Temporario1)
summary(modelo)
```
Remoção do genótipo IRGA 429 que perdeu significancia.

```{r}
Genotipos  <- Temporario1$GENOTIPO
SELECAO_GEN <- c("IRGA 429")

Temporario1$GENOTIPO <- c(ifelse(Temporario1$GENOTIPO %in% SELECAO_GEN, "Nao_significativo" , Genotipos))
modelo<-lm(log(FLO_M)~., Temporario1) 
summary(modelo)
```
### Residuos

```{r}

```
